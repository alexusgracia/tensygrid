<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>msim</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-06-24">
<meta name="DC.source" content="msimDoc.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>msim</h1>
<!--introduction-->
<p>Simulate time response of MTI model to arbitrary inputs</p>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Description</a>
</li>
<li>
<a href="#2">Syntax</a>
</li>
<li>
<a href="#3">Examples</a>
</li>
<li>
<a href="#4">References</a>
</li>
</ul>
</div>
<h2 id="1">Description</h2>
<p>Use <a href="msimDoc.html"><tt>msim</tt></a> to simulate real-valued multilinear time-invariant state-space models in continuous or discrete time, either explicit using the <a href="mssDoc.html"><tt>mss</tt></a> class or implicit using the <a href="dmssDoc.html"><tt>dmss</tt></a> class.</p>
<p>To simulate an MTI system, a corresponding tensor contracted product needs to be solved for each equation. For example, recalling from <a href="mssDoc.html"><tt>mss</tt></a>, for a continuous-time explict MTI state-space model, the state transition equation contracted product is as follows:</p>
<p>
<img src="msimDoc_eq02302696060717589724.png" alt="$$&#10;\dot{\mathbf{x}} = \left\langle \mathrm{F},&#10;\mathrm{M}\left(\mathbf{x},\mathbf{u}\right)\right\rangle ,&#10;$$" style="width:113px;height:15px;"></p>
<p>where <img src="msimDoc_eq11229773766654430573.png" alt="$\mathbf{x}\in\mathrm{R}^n$" style="width:43px;height:11px;"> and <img src="msimDoc_eq01293240461611938355.png" alt="$\mathbf{u}\in\mathrm{R}^m$" style="width:47px;height:11px;">, represent the states and inputs, of sizes <img src="msimDoc_eq17625707915612226655.png" alt="$n\in\mathbf{Z}_{>=0}$" style="width:58px;height:13px;"> and <img src="msimDoc_eq02821698572857285106.png" alt="$m\in\mathbf{Z}_{>=0}$" style="width:62px;height:13px;"> respectively, and <img src="msimDoc_eq17293283163261647945.png" alt="$\mathrm{F}\in\mathbf{R}^{\times^{(n+m)}2\times n}$" style="width:90px;height:15px;"> is the state-space parameter tensors. While <img src="msimDoc_eq01611002717919227034.png" alt="$\mathrm{F}$" style="width:9px;height:11px;"> can have an arbitrary rank, monomial tensors are always rank 1, e.g., <img src="msimDoc_eq16799434469353077689.png" alt="$\mathrm{M}\left(\mathbf{x},\mathbf{u}\right)$" style="width:51px;height:15px;"> canonical polyadic decomposition is:</p>
<p>
<img src="msimDoc_eq08722220137429195979.png" alt="$$&#10;\mathrm{M}\left(\mathbf{x},\mathbf{u}\right) = \left[&#10;\left(\begin{array}{c}1\\x_1\end{array}\right),&#10;\cdots,&#10;\left(\begin{array}{c}1\\x_n\end{array}\right),&#10;\left(\begin{array}{c}1\\u_1\end{array}\right),&#10;\cdots,&#10;\left(\begin{array}{c}1\\u_m\end{array}\right)&#10;\right],&#10;$$" style="width:378px;height:35px;"></p>
<p>where each factor has a single column, i.e., rank 1.</p>
<p>The MTI toolbox stores all tensor parameters in <a href="CPN1Doc.html"><tt>CPN1</tt></a> format, which means for this example that the state-space parameter tensors is reformulated as follows:</p>
<p>
<img src="msimDoc_eq01691190636832349367.png" alt="$$&#10;\mathrm{F} = \left[\mathbf{F}_1, \mathbf{F}_2, \ldots,&#10;\mathbf{F}_{n+m}, \mathbf{F}_{\phi}\right] .&#10;$$" style="width:173px;height:15px;"></p>
<p>Ultimately, this change of format allows for a efficient evaluation of the state transition contracted product:</p>
<p>
<img src="msimDoc_eq01907598690390488099.png" alt="$$&#10;\dot{\mathbf{x}} =&#10;\mathbf{F}_{\phi}\left(\left(\mathbf{F}_{1}^{\top}\left(\begin{array}{c}1\\x_1\end{array}\right)\right)\odot\ldots\odot\left(\mathbf{F}_{n}^{\top}\left(\begin{array}{c}1\\x_n\end{array}\right)\right)\odot\left(\mathbf{F}_{n+1}^{\top}\left(\begin{array}{c}1\\u_1\end{array}\right)\right)\odot\ldots\odot\left(\mathbf{F}_{n+m}^{\top}\left(\begin{array}{c}1\\u_m\end{array}\right)\right)\right),&#10;$$" style="width:606px;height:35px;"></p>
<p>where <img src="msimDoc_eq14987797127281974760.png" alt="$\odot$" style="width:10px;height:10px;"> is the element-wise Hadamard product. Naturally, this simplifcation applies to all tensor contracted product required by MTI systems. For further details, please refer to [1].</p>
<h2 id="2">Syntax</h2>
<p>
<tt>msim(msys,u,t,xo)</tt>
</p>
<p>
<tt>y = msim(msys,u,t,xo)</tt>
</p>
<p>
<tt>y = msim(msys,u,t,xo,interpolationMethod)</tt>
</p>
<p>
<tt>[y,tOut] = msim(msys,u,t,xo)</tt>
</p>
<p>
<tt>[y,tOut, x] = msim(msys,u,t,xo)</tt>
</p>
<p><h2>Description</h2></p>
<p><h2>Response Plots and Data</h2></p>
<p>
<tt>y = msim(msys,u,t,xo)</tt> returns the simulated time response of the MTI dynamic system model <tt>msys</tt> (either explicit using the <tt>mss</tt> class or implicit using the <tt>dmss</tt> class) to the input history <tt>(t,u)</tt> with initial state values <tt>x0</tt>. For more details on dmss simulation see <a href="dmsimDoc.html">dmsim</a>. The vector <tt>t</tt> specifies the time samples for the simulation. For single-input systems, the input signal <tt>u</tt> is a vector of the same length as <tt>t</tt>. For multi-input systems, <tt>u</tt> is an array with as many rows as there are time samples (<tt>length(t)</tt>) and as many columns as there are inputs to <tt>msys</tt>. The function returns the system response <tt>y</tt>, sampled at the same times <tt>t</tt> as the input (using zero-order hold as default for continuous time system models). For single-output systems, <tt>y</tt> is a vector of the same length as <tt>t</tt>. For multi-output systems, <tt>y</tt> is an array having as many rows as there are time samples (<tt>length(t)</tt>) and as many columns as there are outputs in <tt>msys</tt>.</p>
<p>
<tt>y = msim(msys,u,t,xo,interpolationMethod)</tt> allows to change or deactivate the interpolation method for the simulated signals of continuous time system models. <tt>interpolationMethod</tt> can be <tt>"zoh"</tt> , <tt>"foh"</tt> (linear interpolation) or <tt>"none"</tt> (default)(the time steps of the ode solver will be returned).</p>
<p>
<tt>[y,tOut] = msim_)</tt> this formulation also returns the time samples used for the simulation in <tt>tOut</tt>.</p>
<p>
<tt>[y,tOut, x] = msim_)</tt> this formulation also returns the state trajectories <tt>x</tt>. <tt>x</tt> is an array with as many rows as there are time samples and as many columns as there are states in <tt>msys</tt>.</p>
<h2 id="3">Examples</h2>
<pre class="codeinput">
<span class="comment">% LTI model</span>
   A = [-1.5 -3; 3 -1];
   B = [1.3; 0];
   C = [1.15 2.3];
   D = 0;
   lsys = ss(A,B,C,D);       <span class="comment">% LTI model</span>

<span class="comment">% MTI representation</span>

   F = CPN1(eye(3),[A,B]);   <span class="comment">% Transition tensor</span>
   G = CPN1(eye(3),[C,D]);   <span class="comment">% Output tensor</span>
   msys = mss(F,G);          <span class="comment">% MTI model</span>

<span class="comment">% Simulation</span>

   t = 0:0.05:8;             <span class="comment">% time vector</span>
   u = zeros(length(t),1);   <span class="comment">% input sequence</span>
   u(t&gt;=2) = 1;              <span class="comment">% step function</span>
   x0 = [-0.2 0.3];          <span class="comment">% initial state</span>
   [ym, tm, xm] = msim(msys, u, t, x0);
   [yl, tl, xl] = lsim(lsys, u, t, x0);

<span class="comment">% Compare result plots</span>

   subplot(1,2,1), plot(tm,xm)
   subplot(1,2,2), plot(tl,xl)
</pre>
<img vspace="5" hspace="5" src="msimDoc_01.png" alt=""> <h2 id="4">References</h2>
<p>[1] Lichtenberg, Gerwald; Pangalos, Georg; Cateriano Y&aacute;&ntilde;ez, Carlos; Luxa, Aline; J&ouml;res, Niklas; Schnelle, Leona; Kaufmann, Christoph (2022): Implicit multilinear modeling. In at - Automatisierungstechnik 70 (1), pp.&nbsp;13&ndash;30. DOI: 10.1515/auto-2021-0133.</p>
<p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% msim
% Simulate time response of MTI model to arbitrary inputs

%% Description
% Use <msimDoc.html |msim|> to simulate real-valued multilinear time-invariant 
% state-space models in continuous or discrete time, either explicit using 
% the <mssDoc.html |mss|> class or implicit using the <dmssDoc.html |dmss|> class.
%
% To simulate an MTI system, a corresponding tensor contracted product
% needs to be solved for each equation. For example, recalling from <mssDoc.html |mss|>, 
% for a continuous-time explict MTI state-space model, the state transition
% equation contracted product is as follows:
%
% $$
% \dot{\mathbf{x}} = \left\langle \mathrm{F},
% \mathrm{M}\left(\mathbf{x},\mathbf{u}\right)\right\rangle ,
% $$
% 
% where $\mathbf{x}\in\mathrm{R}^n$ and $\mathbf{u}\in\mathrm{R}^m$, represent the states and inputs,
% of sizes $n\in\mathbf{Z}_{>=0}$ and $m\in\mathbf{Z}_{>=0}$ respectively, 
% and $\mathrm{F}\in\mathbf{R}^{\times^{(n+m)}2\times n}$ is the state-space 
% parameter tensors. While $\mathrm{F}$ can have an
% arbitrary rank, monomial tensors are always rank 1, e.g., 
% $\mathrm{M}\left(\mathbf{x},\mathbf{u}\right)$ canonical
% polyadic decomposition is:
%
% $$
% \mathrm{M}\left(\mathbf{x},\mathbf{u}\right) = \left[
% \left(\begin{array}{c}1\\x_1\end{array}\right),
% \cdots,
% \left(\begin{array}{c}1\\x_n\end{array}\right),
% \left(\begin{array}{c}1\\u_1\end{array}\right),
% \cdots,
% \left(\begin{array}{c}1\\u_m\end{array}\right)
% \right],
% $$
%
% where each factor has a single column, i.e., rank 1.
%
% The MTI toolbox stores all tensor parameters in <CPN1Doc.html |CPN1|>
% format, which means for this example that the state-space 
% parameter tensors is reformulated as follows:
%
% $$
% \mathrm{F} = \left[\mathbf{F}_1, \mathbf{F}_2, \ldots,
% \mathbf{F}_{n+m}, \mathbf{F}_{\phi}\right] .
% $$
%
% Ultimately, this change of format allows for a efficient evaluation of 
% the state transition contracted product:
%
% $$
% \dot{\mathbf{x}} =
% \mathbf{F}_{\phi}\left(\left(\mathbf{F}_{1}^{\top}\left(\begin{array}{c}1\\x_1\end{array}\right)\right)\odot\ldots\odot\left(\mathbf{F}_{n}^{\top}\left(\begin{array}{c}1\\x_n\end{array}\right)\right)\odot\left(\mathbf{F}_{n+1}^{\top}\left(\begin{array}{c}1\\u_1\end{array}\right)\right)\odot\ldots\odot\left(\mathbf{F}_{n+m}^{\top}\left(\begin{array}{c}1\\u_m\end{array}\right)\right)\right),
% $$
%
% where $\odot$ is the element-wise Hadamard product. Naturally, this
% simplifcation applies to all tensor contracted product required by MTI
% systems. For further details, please refer to [1].
%

%% Syntax
% |msim(msys,u,t,xo)|
%
% |y = msim(msys,u,t,xo)|
%
% |y = msim(msys,u,t,xo,interpolationMethod)|
%
% |[y,tOut] = msim(msys,u,t,xo)|
%
% |[y,tOut, x] = msim(msys,u,t,xo)|
%
% <html><h2>Description</h2></html>
% 
% <html><h2>Response Plots and Data</h2></html>
%
% |y = msim(msys,u,t,xo)| returns the simulated time response of the MTI 
% dynamic system model |msys| (either explicit using the |mss| class or implicit using the |dmss| class) 
% to the input history |(t,u)| with initial state values |x0|. For more
% details on dmss simulation see <dmsimDoc.html dmsim>.
% The vector |t| specifies the time samples for the simulation.
% For single-input systems, the input signal |u| is a vector of the same 
% length as |t|. For multi-input systems, |u| is an array with as many rows as there are time samples (|length(t)|)
% and as many columns as there are inputs to |msys|. The function returns the 
% system response |y|, sampled at the same times |t| as the input (using zero-order hold as default for continuous time system models). 
% For single-output systems, |y| is a vector of the same length as |t|. For multi-output systems, 
% |y| is an array having as many rows as there are time samples (|length(t)|)
% and as many columns as there are outputs in |msys|.
%
% |y = msim(msys,u,t,xo,interpolationMethod)| allows to change or
% deactivate the interpolation method for the simulated signals of
% continuous time system models.
% |interpolationMethod| can be |"zoh"| , |"foh"| (linear
% interpolation) or |"none"| (default)(the time steps of the ode solver will be returned).
%
% |[y,tOut] = msim(___)| this formulation also returns the time 
% samples used for the simulation in |tOut|.
%
% |[y,tOut, x] = msim(___)| this formulation also returns the state 
% trajectories |x|. |x| is an array with as many rows as there are time 
% samples and as many columns as there are states in |msys|.
%
%% Examples

% LTI model 
   A = [-1.5 -3; 3 -1];    
   B = [1.3; 0];           
   C = [1.15 2.3];         
   D = 0;
   lsys = ss(A,B,C,D);       % LTI model

% MTI representation 

   F = CPN1(eye(3),[A,B]);   % Transition tensor
   G = CPN1(eye(3),[C,D]);   % Output tensor
   msys = mss(F,G);          % MTI model

% Simulation   
   
   t = 0:0.05:8;             % time vector
   u = zeros(length(t),1);   % input sequence
   u(t>=2) = 1;              % step function  
   x0 = [-0.2 0.3];          % initial state 
   [ym, tm, xm] = msim(msys, u, t, x0); 
   [yl, tl, xl] = lsim(lsys, u, t, x0);

% Compare result plots 

   subplot(1,2,1), plot(tm,xm)
   subplot(1,2,2), plot(tl,xl)

%% References
%
% [1] Lichtenberg, Gerwald; Pangalos, Georg; Cateriano Yáñez, Carlos; Luxa,
% Aline; Jöres, Niklas; Schnelle, Leona; Kaufmann, Christoph (2022): 
% Implicit multilinear modeling. In at - Automatisierungstechnik 70 (1), 
% pp. 13–30. DOI: 10.1515/auto-2021-0133.
%

##### SOURCE END #####
-->
</body>
</html>
